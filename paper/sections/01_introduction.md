# 1. 引言 (Introduction)

## 1.1 研究背景与动机

随着移动机器人在物流配送、家庭服务、自动驾驶等领域的广泛应用，如何在非结构化和动态环境中实现安全、高效的自主导航成为了机器人学研究的核心问题之一。在这些场景中，机器人不仅需要快速响应环境变化，还必须严格保证自身与周围障碍物之间的安全距离——这一"硬约束"的违背将直接导致碰撞事故，造成不可逆的损失。因此，如何在保证安全性的前提下实现实时控制，是移动机器人规划领域的核心挑战。

模型预测控制（Model Predictive Control, MPC）因其能够显式处理系统约束和优化未来轨迹，已成为解决受限控制问题的标准方法。然而，传统的基于优化的MPC方法在处理复杂环境时面临着严峻的计算挑战。例如，基于欧几里得符号距离场（ESDF）的方法虽然能够提供精确的碰撞梯度，但构建和更新ESDF的过程计算量巨大，难以满足高速移动机器人（10-100Hz）的实时性要求。在我们的实验中，即使使用工业级求解器CVXPY，单次MPC优化也需要约2秒，这意味着控制频率仅能达到0.5Hz——远远无法应对快速变化的动态障碍物。

## 1.2 现有方法的局限性

现有的导航方法主要分为两大类，各自面临着根本性的局限：

**基于优化的方法**（如非线性MPC）具有理论上的完备性和可解释性，能够严格满足安全约束。然而，在非凸环境中求解优化问题通常需要大量的迭代计算，导致控制频率低，难以应对快速动态障碍物。此外，为了获取碰撞约束的梯度信息，往往需要对环境进行复杂的建模（如多面体分解或距离场构建），进一步增加了计算负担。更为关键的是，优化问题的非凸性可能导致求解器陷入局部最优或收敛失败，影响系统的可靠性。

**基于学习的方法**（如深度强化学习或模仿学习）通过神经网络直接从传感器数据映射到控制指令，具有极高的推理速度（通常<10ms）和对复杂环境的适应能力。然而，这类"黑盒"方法存在根本性的安全隐患——它们无法保证输出满足硬性约束。虽然可以通过设计惩罚函数来引导网络学习避障，但在训练分布之外的极端场景下，网络输出的动作可能严重违反安全边界。这种"长尾风险"在安全攸关的机器人控制任务中是不可接受的。

近年来，**算法展开（Algorithm Unrolling）**技术为解决上述矛盾提供了新的思路。通过将传统的优化算法（如梯度下降、ADMM、PDHG）展开为神经网络层，可以结合深度学习的拟合能力和优化算法的结构先验。然而，现有的展开方法（如ISTA-Net、ADMM-Net）大多仍采用软惩罚的方式处理约束，或者仅在简单的凸问题上取得了成功。在复杂的非凸避障控制问题上，如何保证严格的约束满足和实时性仍然是一个开放的挑战。

## 1.3 本文方法

为了解决上述挑战，本文提出了一种名为**NeuPAN（Neural Proximal Alternating-minimization Network）**的实时运动规划框架，以及其核心组件**PDPL-Net（Primal-Dual Proximal Learning Network）**。本文的核心思想可以概括为"结构化展开+硬投影保障"：

首先，我们将非凸的避障优化问题通过对偶变换重构为双凸（Biconvex）形式，使得交替优化成为可能。在此基础上，我们将**原始-对偶混合梯度法（PDHG）**展开为可训练的神经网络架构。与传统展开方法不同，PDPL-Net引入了**可学习的近端算子**，允许网络根据环境特征自适应地调整优化步长和方向，实现了在极少迭代次数（$J=1\sim2$）下的快速收敛。

更为关键的是，我们在网络架构中设计了**硬投影层（Hard Projection Layer）**。该层通过显式的几何投影操作（非负锥投影和二阶锥投影），从数学上严格保证网络输出满足对偶可行性约束$\mu \geq 0$和$\|G^\top \mu\|_2 \leq 1$。这一设计将安全保证从"软惩罚"提升到了"硬保障"的层面——无论网络的预测如何偏差，最终输出都被强制约束在可行域内。

此外，我们提出了基于**KKT（Karush-Kuhn-Tucker）条件**的残差正则化训练策略，通过在损失函数中引入原始可行性、对偶可行性和互补松弛性的残差项，使网络输出不仅在数值上接近最优解，更在物理意义上满足最优性条件，从而提升了模型在分布外场景中的泛化能力。

## 1.4 本文贡献

本文的主要贡献总结如下：

1. **提出了一种新型的约束保证神经展开架构**：将PDHG算法展开为深度神经网络PDPL-Net，并在架构层面嵌入硬投影层，实现了100%的约束满足率——这是首个在点级对偶变量预测任务上达到完全约束保证的学习方法。

2. **设计了可学习近端算子加速收敛**：通过数据驱动的方式学习问题结构的先验知识，使网络在仅1-2层展开下即可达到与精确求解器相当的精度（MSE $\sim 10^{-5}$），同时实现954倍的速度提升。

3. **提出了基于KKT残差的物理信息训练策略**：将优化理论的最优性条件编码为正则化损失，使网络输出在统计意义上更加接近最优解，提升了模型在动态障碍物等分布外场景中的泛化能力。

4. **建立了全面的基线评测框架**：构建了包含12种代表性方法的综合评测体系，涵盖传统优化、黑盒神经网络和算法展开三大类方法，为该领域的后续研究提供了标准化的对比基准。

5. **验证了闭环MPC系统的实际效果**：在静态走廊、密集障碍物和动态行人等多种典型场景中进行了100轮闭环实验，证明了PDPL-Net在真实控制任务中的有效性和鲁棒性。
