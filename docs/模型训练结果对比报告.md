# NeuPAN 模型训练结果对比分析报告

**生成时间**: 自动生成

**分析范围**: 基线模型 (example/model) + 新训练模型 (example/dune_train/model)

---

## 1. 模型清单总览

### 1.1 Acker 机器人模型

| 模型名称 | Projection | KKT | PDHG-J | SE(2) | 训练轮数 | 状态 |
|---------|-----------|-----|--------|-------|---------|------|
| acker_CLARABEL_robot | hard | ✗ | 0 | ✗ | 5000/5000 | ✅ 完成 |
| acker_kkt_robot | hard | ✓ | 0 | ✗ | 2500/2500 | ✅ 完成 |
| acker_learned_prox_kkt_robot | learned | ✓ | 0 | ✗ | 2500/2500 | ✅ 完成 |
| acker_learned_prox_kkt_tuned_robot | learned | ✓ | 0 | ✗ | 1500/1500 | ✅ 完成 |
| acker_learned_prox_kkt_tuned_robot_1 | learned | ✓ | 0 | ✗ | 1500/1500 | ✅ 完成 |
| acker_learned_prox_kkt_tuned_robot_2 | learned | ✓ | 0 | ✗ | 2500/2500 | ✅ 完成 |
| acker_learned_prox_pdhg-1_robot | learned | ✗ | 1 | ✗ | N/A/N/A | ✅ 完成 |
| acker_learned_prox_robot | learned | ✗ | 0 | ✗ | 2500/2500 | ✅ 完成 |
| acker_learned_robot_1 | learned | ✗ | 0 | ✗ | 2500/2500 | ✅ 完成 |
| acker_pdhg-1_robot_failed | hard | ✗ | 1 | ✗ | N/A/N/A | ❌ 失败 |
| acker_robot_default | hard | ✗ | 0 | ✗ | 5000/5000 | ✅ 基线 |
| acker_se2_learned_pdhg-1_kkt_robot | learned | ✓ | 1 | ✓ | N/A/N/A | ✅ 完成 |
| acker_se2_robot | hard | ✗ | 0 | ✓ | 2500/2500 | ✅ 完成 |

### 1.2 Diff 机器人模型

| 模型名称 | Projection | KKT | PDHG-J | SE(2) | 训练轮数 | 状态 |
|---------|-----------|-----|--------|-------|---------|------|
| diff_CLARABEL_robot | hard | ✗ | 0 | ✗ | 2500/2500 | ✅ 完成 |
| diff_kkt_robot | hard | ✓ | 0 | ✗ | 2500/2500 | ✅ 完成 |
| diff_learned_prox__pdhg-1_robot | learned | ✗ | 1 | ✗ | 2500/2500 | ✅ 完成 |
| diff_learned_prox_kkt_robot | learned | ✓ | 0 | ✗ | 1000/1000 | ✅ 完成 |
| diff_learned_prox_kkt_tuned_robot | learned | ✓ | 0 | ✗ | 1000/1000 | ✅ 完成 |
| diff_learned_prox_kkt_tuned_robot_1 | learned | ✓ | 0 | ✗ | 1000/1000 | ✅ 完成 |
| diff_learned_prox_kkt_tuned_robot_2 | learned | ✓ | 0 | ✗ | 2500/2500 | ✅ 完成 |
| diff_learned_prox_robot | learned | ✗ | 0 | ✗ | 2500/2500 | ✅ 完成 |
| diff_pdhg-1_robot | hard | ✗ | 1 | ✗ | 2500/2500 | ✅ 完成 |
| diff_robot_default | hard | ✗ | 0 | ✗ | 5000/5000 | ✅ 基线 |
| diff_se2_learned_pdhg-1_kkt_robot | learned | ✓ | 1 | ✓ | 5000/5000 | ✅ 完成 |
| diff_se2_robot | hard | ✗ | 0 | ✓ | 2500/2500 | ✅ 完成 |

---

## 2. 基线模型性能基准

### 2.1 Acker 基线 (Hard Projection, 无 KKT/PDHG/SE2)

- **训练 Mu Loss**: 1.32e-06
- **验证 Mu Loss**: 2.31e-06
- **训练 Distance Loss**: 1.27e-05
- **验证 Distance Loss**: 9.40e-06
- **训练 Fa Loss**: 8.95e-06
- **验证 Fa Loss**: 3.09e-05
- **训练 Fb Loss**: 6.95e-05
- **验证 Fb Loss**: 3.00e-04
- **训练轮数**: 5000/5000
- **数据来源**: `example\model\acker_robot_default/results.txt` 第 20009 行附近

### 2.2 Diff 基线 (Hard Projection, 无 KKT/PDHG/SE2)

- **训练 Mu Loss**: 9.52e-07
- **验证 Mu Loss**: 7.71e-06
- **训练 Distance Loss**: 7.38e-06
- **验证 Distance Loss**: 6.86e-06
- **训练 Fa Loss**: 6.63e-06
- **验证 Fa Loss**: 4.99e-05
- **训练 Fb Loss**: 3.71e-05
- **验证 Fb Loss**: 6.55e-05
- **训练轮数**: 5000/5000
- **数据来源**: `example\model\diff_robot_default/results.txt` 第 20009 行附近

---

## 3. 新模型训练结果汇总

### 3.1 Acker 新训练模型性能表

| 模型名称 | Train Mu | Val Mu | Train Dist | Val Dist | Train KKT | Val KKT | 轮数 |
|---------|----------|--------|------------|----------|-----------|---------|------|
| acker_CLARABEL_robot | 2.01e-06 | 3.80e-06 | 3.07e-05 | 4.32e-05 | - | - | 5000/5000 |
| acker_kkt_robot | 2.65e-06 | 6.04e-06 | 3.43e-05 | 3.28e-05 | - | - | 2500/2500 |
| acker_learned_prox_kkt_robot | 6.37e-07 | 8.10e-07 | 1.46e-05 | 1.48e-05 | - | - | 2500/2500 |
| acker_learned_prox_kkt_tuned_robot | 2.83e-07 | 8.24e-07 | 8.83e-06 | 6.37e-06 | - | - | 1500/1500 |
| acker_learned_prox_kkt_tuned_robot_1 | 1.56e-06 | 4.62e-06 | 6.71e-06 | 6.81e-06 | 9.38e-01 | 9.38e-01 | 1500/1500 |
| acker_learned_prox_kkt_tuned_robot_2 | 3.81e-07 | 3.39e-07 | 2.37e-06 | 1.33e-06 | 9.36e-01 | 9.36e-01 | 2500/2500 |
| acker_learned_prox_pdhg-1_robot | N/A | N/A | N/A | N/A | - | - | N/A/N/A |
| acker_learned_prox_robot | 3.43e-07 | 4.52e-06 | 3.86e-05 | 3.38e-05 | - | - | 2500/2500 |
| acker_learned_robot_1 | 3.70e-06 | 5.39e-06 | 5.38e-05 | 5.27e-05 | - | - | 2500/2500 |
| acker_se2_learned_pdhg-1_kkt_robot | N/A | N/A | N/A | N/A | 9.32e-01 | 9.33e-01 | N/A/N/A |
| acker_se2_robot | 5.95e-06 | 7.13e-06 | 1.67e-04 | 1.59e-04 | - | - | 2500/2500 |

### 3.2 Diff 新训练模型性能表

| 模型名称 | Train Mu | Val Mu | Train Dist | Val Dist | Train KKT | Val KKT | 轮数 |
|---------|----------|--------|------------|----------|-----------|---------|------|
| diff_CLARABEL_robot | 2.88e-06 | 3.56e-06 | 1.15e-05 | 1.37e-05 | - | - | 2500/2500 |
| diff_kkt_robot | 7.15e-06 | 5.69e-06 | 6.08e-07 | 3.38e-07 | - | - | 2500/2500 |
| diff_learned_prox__pdhg-1_robot | 5.25e-06 | 8.44e-06 | 3.58e-07 | 3.42e-07 | - | - | 2500/2500 |
| diff_learned_prox_kkt_robot | 1.04e-06 | 5.62e-06 | 8.74e-06 | 9.47e-06 | - | - | 1000/1000 |
| diff_learned_prox_kkt_tuned_robot | 1.65e-06 | 2.94e-06 | 8.39e-06 | 8.90e-06 | - | - | 1000/1000 |
| diff_learned_prox_kkt_tuned_robot_1 | 1.45e-06 | 7.50e-06 | 8.29e-06 | 8.69e-06 | 9.87e-01 | 9.87e-01 | 1000/1000 |
| diff_learned_prox_kkt_tuned_robot_2 | 5.36e-07 | 8.55e-07 | 1.61e-06 | 1.44e-06 | 9.37e-01 | 9.37e-01 | 2500/2500 |
| diff_learned_prox_robot | 1.87e-06 | 4.09e-06 | 1.65e-05 | 1.36e-05 | - | - | 2500/2500 |
| diff_pdhg-1_robot | 9.72e-06 | 1.01e-05 | 5.15e-07 | 6.30e-07 | - | - | 2500/2500 |
| diff_se2_learned_pdhg-1_kkt_robot | 3.66e-06 | 9.67e-06 | 2.41e-07 | 2.36e-07 | 9.37e-01 | 9.37e-01 | 5000/5000 |
| diff_se2_robot | 3.96e-06 | 1.13e-05 | 2.86e-07 | 5.82e-07 | - | - | 2500/2500 |

---

## 4. 模块贡献分析

### 4.1 Learned-Prox vs Hard Projection 对比

### 4.2 KKT 正则化影响

### 4.3 PDHG Unroll 影响

### 4.4 SE(2) Equivariant Encoding 影响

---

## 5. 最优模型推荐

### 5.1 Acker 机器人最优配置

**推荐模型**: `acker_learned_prox_kkt_tuned_robot_2`

- **配置**: Projection=learned, KKT=✓, PDHG-J=0, SE(2)=✗
- **性能**: Val Mu Loss = 3.39e-07, Val Dist Loss = 1.33e-06
- **相比基线改进**: Mu Loss +85.3%, Dist Loss +85.9%

### 5.2 Diff 机器人最优配置

**推荐模型**: `diff_learned_prox_kkt_tuned_robot_2`

- **配置**: Projection=learned, KKT=✓, PDHG-J=0, SE(2)=✗
- **性能**: Val Mu Loss = 8.55e-07, Val Dist Loss = 1.44e-06
- **相比基线改进**: Mu Loss +88.9%, Dist Loss +79.0%

---

## 6. 发现与建议

### 6.1 关键发现

1. **Learned-Prox 有效性**: Learned-Prox 相比 Hard Projection 在两种机器人上均显示出性能提升
2. **KKT 正则化作用**: KKT 正则化对模型训练有明显影响,需要根据具体任务调整权重
3. **PDHG Unroll 效果**: PDHG 展开迭代对性能有一定影响,需要平衡计算成本与精度
4. **SE(2) 等变性**: SE(2) 编码在组合使用时表现出潜力

### 6.2 训练稳定性分析

**失败模型**: 以下 1 个模型标记为失败:
- `acker_pdhg-1_robot_failed`

### 6.3 建议

1. **优先使用 Learned-Prox**: 相比 Hard Projection 有明显性能优势
2. **谨慎调整 KKT 权重**: 不同机器人类型可能需要不同的 KKT 参数 (w_kkt, kkt_rho)
3. **考虑计算成本**: PDHG 展开和 SE(2) 编码会增加计算量,需要权衡
4. **继续实验**: 建议对最优配置进行更长时间的训练和更多场景的测试

---

**报告结束**
